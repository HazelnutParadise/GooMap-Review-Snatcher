import{S as ve,i as be,s as ge,d as b,t as P,b as Q,r as q,e as me,h as A,u as d,N as we,v as O,I as re,O as ke,z as H,w as y,x as C,y as J,C as M,A as z,B as K,q as Te,o as ee,a as fe,m as _e,j as de,f as pe,M as Y,P as W,Q as X,R as te,T as je,H as Z,K as x,g as Se}from"../chunks/index-DKDS-ryU.js";import{I as Ee,e as V}from"../chunks/InputCard-CvUDLqnd.js";import ye from"./Loader-p3qQwWDn.js";import"./InfoCard-B540fG_b.js";const ze=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,{document:$}=ze;function oe(r,e,s){const l=r.slice();return l[17]=e[s],l}function ae(r,e,s){const l=r.slice();return l[20]=e[s],l}function ce(r,e,s){const l=r.slice();return l[23]=e[s],l}function Oe(r){let e,s="查詢其他商家",l,t,n,f=r[3].Name+"",o,T,_,i="下載 CSV",S,m,U="下載 JSON",F,w,v,I,R,B,u,h,k,E=V(Object.keys(r[6][0])),p=[];for(let c=0;c<E.length;c+=1)p[c]=ie(ce(r,E,c));let D=V(r[6]),g=[];for(let c=0;c<D.length;c+=1)g[c]=he(oe(r,D,c));return{c(){e=z("button"),e.textContent=s,l=M(),t=z("div"),n=z("h3"),o=K(f),T=M(),_=z("button"),_.textContent=i,S=M(),m=z("button"),m.textContent=U,F=M(),w=z("div"),v=z("table"),I=z("thead"),R=z("tr");for(let c=0;c<p.length;c+=1)p[c].c();B=M(),u=z("tbody");for(let c=0;c<g.length;c+=1)g[c].c();this.h()},l(c){e=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),x(e)!=="svelte-gc4oaf"&&(e.textContent=s),l=H(c),t=y(c,"DIV",{class:!0});var j=C(t);n=y(j,"H3",{class:!0});var a=C(n);o=J(a,f),a.forEach(b),T=H(j),_=y(j,"BUTTON",{class:!0,"data-svelte-h":!0}),x(_)!=="svelte-1cm302j"&&(_.textContent=i),S=H(j),m=y(j,"BUTTON",{class:!0,"data-svelte-h":!0}),x(m)!=="svelte-zkdu87"&&(m.textContent=U),F=H(j),w=y(j,"DIV",{class:!0});var L=C(w);v=y(L,"TABLE",{class:!0});var N=C(v);I=y(N,"THEAD",{});var le=C(I);R=y(le,"TR",{class:!0});var se=C(R);for(let G=0;G<p.length;G+=1)p[G].l(se);se.forEach(b),le.forEach(b),B=H(N),u=y(N,"TBODY",{});var ne=C(u);for(let G=0;G<g.length;G+=1)g[G].l(ne);ne.forEach(b),N.forEach(b),L.forEach(b),j.forEach(b),this.h()},h(){O(e,"class","reset-button button svelte-zppriv"),O(n,"class","store-name svelte-zppriv"),O(_,"class","download-button button svelte-zppriv"),O(m,"class","download-button button svelte-zppriv"),O(R,"class","svelte-zppriv"),O(v,"class","review-table svelte-zppriv"),O(w,"class","review-table-box svelte-zppriv"),O(t,"class","review-box svelte-zppriv")},m(c,j){A(c,e,j),A(c,l,j),A(c,t,j),d(t,n),d(n,o),d(t,T),d(t,_),d(t,S),d(t,m),d(t,F),d(t,w),d(w,v),d(v,I),d(I,R);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(R,null);d(v,B),d(v,u);for(let a=0;a<g.length;a+=1)g[a]&&g[a].m(u,null);h||(k=[Z(e,"click",r[14]),Z(_,"click",r[15]),Z(m,"click",r[16])],h=!0)},p(c,j){if(j&8&&f!==(f=c[3].Name+"")&&q(o,f),j&64){E=V(Object.keys(c[6][0]));let a;for(a=0;a<E.length;a+=1){const L=ce(c,E,a);p[a]?p[a].p(L,j):(p[a]=ie(L),p[a].c(),p[a].m(R,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=E.length}if(j&64){D=V(c[6]);let a;for(a=0;a<D.length;a+=1){const L=oe(c,D,a);g[a]?g[a].p(L,j):(g[a]=he(L),g[a].c(),g[a].m(u,null))}for(;a<g.length;a+=1)g[a].d(1);g.length=D.length}},i:ee,o:ee,d(c){c&&(b(e),b(l),b(t)),te(p,c),te(g,c),h=!1,je(k)}}}function Ie(r){let e,s,l,t,n;function f(i){r[11](i)}function o(i){r[12](i)}function T(i){r[13](i)}let _={handleSearch:r[8],handleGetReview:r[9],storeData:r[5]};return r[4]!==void 0&&(_.pagesToFetch=r[4]),r[2]!==void 0&&(_.searchInputStr=r[2]),r[3]!==void 0&&(_.selectedStore=r[3]),e=new Ee({props:_}),Y.push(()=>W(e,"pagesToFetch",f)),Y.push(()=>W(e,"searchInputStr",o)),Y.push(()=>W(e,"selectedStore",T)),{c(){pe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,S){_e(e,i,S),n=!0},p(i,S){const m={};S&32&&(m.storeData=i[5]),!s&&S&16&&(s=!0,m.pagesToFetch=i[4],X(()=>s=!1)),!l&&S&4&&(l=!0,m.searchInputStr=i[2],X(()=>l=!1)),!t&&S&8&&(t=!0,m.selectedStore=i[3],X(()=>t=!1)),e.$set(m)},i(i){n||(Q(e.$$.fragment,i),n=!0)},o(i){P(e.$$.fragment,i),n=!1},d(i){fe(e,i)}}}function Be(r){let e,s;return e=new ye({}),{c(){pe(e.$$.fragment)},l(l){de(e.$$.fragment,l)},m(l,t){_e(e,l,t),s=!0},p:ee,i(l){s||(Q(e.$$.fragment,l),s=!0)},o(l){P(e.$$.fragment,l),s=!1},d(l){fe(e,l)}}}function ie(r){let e,s=r[23]+"",l;return{c(){e=z("th"),l=K(s),this.h()},l(t){e=y(t,"TH",{class:!0});var n=C(e);l=J(n,s),n.forEach(b),this.h()},h(){O(e,"class","svelte-zppriv")},m(t,n){A(t,e,n),d(e,l)},p(t,n){n&64&&s!==(s=t[23]+"")&&q(l,s)},d(t){t&&b(e)}}}function ue(r){let e,s=r[20]+"",l;return{c(){e=z("td"),l=K(s),this.h()},l(t){e=y(t,"TD",{class:!0});var n=C(e);l=J(n,s),n.forEach(b),this.h()},h(){O(e,"class","svelte-zppriv")},m(t,n){A(t,e,n),d(e,l)},p(t,n){n&64&&s!==(s=t[20]+"")&&q(l,s)},d(t){t&&b(e)}}}function he(r){let e,s,l=V(Object.values(r[17])),t=[];for(let n=0;n<l.length;n+=1)t[n]=ue(ae(r,l,n));return{c(){e=z("tr");for(let n=0;n<t.length;n+=1)t[n].c();s=M(),this.h()},l(n){e=y(n,"TR",{class:!0});var f=C(e);for(let o=0;o<t.length;o+=1)t[o].l(f);s=H(f),f.forEach(b),this.h()},h(){O(e,"class","svelte-zppriv")},m(n,f){A(n,e,f);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null);d(e,s)},p(n,f){if(f&64){l=V(Object.values(n[17]));let o;for(o=0;o<l.length;o+=1){const T=ae(n,l,o);t[o]?t[o].p(T,f):(t[o]=ue(T),t[o].c(),t[o].m(e,s))}for(;o<t.length;o+=1)t[o].d(1);t.length=l.length}},d(n){n&&b(e),te(t,n)}}}function Ce(r){let e,s,l,t,n,f,o,T,_,i,S,m,U,F,w,v,I;$.title=e=r[0]+" - 榛果繽紛樂";const R=[Be,Ie,Oe],B=[];function u(h,k){return k&64&&(F=null),h[7]?0:(F==null&&(F=Object.keys(h[6]).length==0),F?1:2)}return w=u(r,-1),v=B[w]=R[w](r),{c(){s=M(),l=z("div"),t=z("img"),f=M(),o=z("div"),T=z("h1"),_=K(r[0]),i=M(),S=z("h2"),m=K(r[1]),U=M(),v.c(),this.h()},l(h){ke("svelte-wrcujp",$.head).forEach(b),s=H(h),l=y(h,"DIV",{class:!0});var E=C(l);t=y(E,"IMG",{src:!0,alt:!0,style:!0}),f=H(E),o=y(E,"DIV",{class:!0});var p=C(o);T=y(p,"H1",{class:!0});var D=C(T);_=J(D,r[0]),D.forEach(b),i=H(p),S=y(p,"H2",{class:!0});var g=C(S);m=J(g,r[1]),g.forEach(b),p.forEach(b),U=H(E),v.l(E),E.forEach(b),this.h()},h(){we(t.src,n="https://src.hazelnut-paradise.com/GooMapReviewSnatcher.png")||O(t,"src",n),O(t,"alt","GooMapReviewSnatcher"),re(t,"width","100%"),re(t,"max-width","150px"),O(T,"class","title svelte-zppriv"),O(S,"class","subtitle svelte-zppriv"),O(o,"class","title-box svelte-zppriv"),O(l,"class","container svelte-zppriv")},m(h,k){A(h,s,k),A(h,l,k),d(l,t),d(l,f),d(l,o),d(o,T),d(T,_),d(o,i),d(o,S),d(S,m),d(l,U),B[w].m(l,null),I=!0},p(h,[k]){(!I||k&1)&&e!==(e=h[0]+" - 榛果繽紛樂")&&($.title=e),(!I||k&1)&&q(_,h[0]),(!I||k&2)&&q(m,h[1]);let E=w;w=u(h,k),w===E?B[w].p(h,k):(Se(),P(B[E],1,1,()=>{B[E]=null}),me(),v=B[w],v?v.p(h,k):(v=B[w]=R[w](h),v.c()),Q(v,1),v.m(l,null))},i(h){I||(Q(v),I=!0)},o(h){P(v),I=!1},d(h){h&&(b(s),b(l)),B[w].d()}}}const Re="/api/search",De="/api/reviews";function Ne(r,e,s){let{title:l}=e,{subtitle:t}=e,n="",f="",o=1,T=[],_=[],i=!1;const S=async()=>{if(s(7,i=!0),console.log(n),n===""){alert("請輸入搜尋關鍵字"),s(7,i=!1);return}try{const u=await fetch(Re+`?storeName=${n}`);if(!u.ok){console.error("Error:",u.statusText),alert("無法取得搜尋結果");return}s(5,T=await u.json()),console.log(T)}catch(u){console.error(u),alert("無法取得搜尋結果")}finally{s(7,i=!1)}},m=async()=>{if(s(7,i=!0),console.log(f),f===""){alert("請選擇店家"),s(7,i=!1);return}try{const u=await fetch(De+`?storeID=${f.ID}&pages=${o}`);if(!u.ok){console.error("Error:",u.statusText),alert("無法取得評論");return}s(6,_=await u.json()),console.log(_)}catch(u){console.error(u),alert("無法取得評論")}finally{s(7,i=!1)}},U=u=>{const h=document.createElement("a");let k="";switch(u){case"csv":const E=new Uint8Array([239,187,191]),p=Object.keys(_[0]).join(","),D=_.map(L=>Object.values(L).map(N=>typeof N=="string"&&(N.includes(",")||N.includes(`
`)||N.includes('"'))?`"${N.replace(/"/g,'""')}"`:N).join(",")),g=p+`
`+D.join(`
`),c=new Blob([E,g],{type:"text/csv;charset=utf-8"});k=window.URL.createObjectURL(c),h.href=k,h.download=`${f.Name}.csv`,h.click();break;case"json":const j=JSON.stringify(_,null,2),a=new Blob([j],{type:"application/json;charset=utf-8"});k=window.URL.createObjectURL(a),h.href=k,h.download=`${f.Name}.json`,h.click();break}window.URL.revokeObjectURL(k)};Te(async()=>{getNavbar()});function F(u){o=u,s(4,o)}function w(u){n=u,s(2,n)}function v(u){f=u,s(3,f)}const I=()=>{s(2,n=""),s(5,T=[]),s(6,_=[])},R=()=>U("csv"),B=()=>U("json");return r.$$set=u=>{"title"in u&&s(0,l=u.title),"subtitle"in u&&s(1,t=u.subtitle)},[l,t,n,f,o,T,_,i,S,m,U,F,w,v,I,R,B]}class Me extends ve{constructor(e){super(),be(this,e,Ne,Ce,ge,{title:0,subtitle:1})}}export{Me as default};
