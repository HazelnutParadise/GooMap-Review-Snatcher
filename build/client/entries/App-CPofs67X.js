import{S as se,i as ne,s as re,d as j,t as O,b as F,r as P,e as oe,h as Q,u as v,K as ae,v as I,H as W,L as le,z as C,w as U,x as q,y as X,C as A,A as E,B as Y,q as ce,o as ie,a as z,m as J,j as V,f as K,J as R,M as T,N as L,g as ue}from"../chunks/index-BcAQgaGx.js";import fe from"./InputCard-BxUagq9k.js";import pe from"./Loader-CT3sUNCL.js";import _e from"./Result-DiaCZL2u.js";import"../chunks/each-D6YF6ztN.js";import"./InfoCard-l3ckkPzU.js";const de=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,{document:H}=de;function he(n){let t,s,o,c;function _(r){n[16](r)}function i(r){n[17](r)}let u={selectedStore:n[3],searchInputStr:n[2],download:n[11],handleReset:n[8]};return n[5]!==void 0&&(u.storeData=n[5]),n[6]!==void 0&&(u.reviews=n[6]),t=new _e({props:u}),R.push(()=>T(t,"storeData",_)),R.push(()=>T(t,"reviews",i)),{c(){K(t.$$.fragment)},l(r){V(t.$$.fragment,r)},m(r,l){J(t,r,l),c=!0},p(r,l){const f={};l&8&&(f.selectedStore=r[3]),l&4&&(f.searchInputStr=r[2]),!s&&l&32&&(s=!0,f.storeData=r[5],L(()=>s=!1)),!o&&l&64&&(o=!0,f.reviews=r[6],L(()=>o=!1)),t.$set(f)},i(r){c||(F(t.$$.fragment,r),c=!0)},o(r){O(t.$$.fragment,r),c=!1},d(r){z(t,r)}}}function ge(n){let t,s,o,c,_,i;function u(a){n[12](a)}function r(a){n[13](a)}function l(a){n[14](a)}function f(a){n[15](a)}let h={handleSearch:n[9],handleGetReview:n[10]};return n[2]!==void 0&&(h.searchInputStr=n[2]),n[3]!==void 0&&(h.selectedStore=n[3]),n[5]!==void 0&&(h.storeData=n[5]),n[4]!==void 0&&(h.pagesToFetch=n[4]),t=new fe({props:h}),R.push(()=>T(t,"searchInputStr",u)),R.push(()=>T(t,"selectedStore",r)),R.push(()=>T(t,"storeData",l)),R.push(()=>T(t,"pagesToFetch",f)),{c(){K(t.$$.fragment)},l(a){V(t.$$.fragment,a)},m(a,m){J(t,a,m),i=!0},p(a,m){const w={};!s&&m&4&&(s=!0,w.searchInputStr=a[2],L(()=>s=!1)),!o&&m&8&&(o=!0,w.selectedStore=a[3],L(()=>o=!1)),!c&&m&32&&(c=!0,w.storeData=a[5],L(()=>c=!1)),!_&&m&16&&(_=!0,w.pagesToFetch=a[4],L(()=>_=!1)),t.$set(w)},i(a){i||(F(t.$$.fragment,a),i=!0)},o(a){O(t.$$.fragment,a),i=!1},d(a){z(t,a)}}}function be(n){let t,s;return t=new pe({}),{c(){K(t.$$.fragment)},l(o){V(t.$$.fragment,o)},m(o,c){J(t,o,c),s=!0},p:ie,i(o){s||(F(t.$$.fragment,o),s=!0)},o(o){O(t.$$.fragment,o),s=!1},d(o){z(t,o)}}}function me(n){let t,s,o,c,_,i,u,r,l,f,h,a,m,w,g,b,S;H.title=t=n[0]+" - 榛果繽紛樂";const B=[be,ge,he],k=[];function M(e,p){return p&64&&(w=null),e[7]?0:(w==null&&(w=Object.keys(e[6]).length==0),w?1:2)}return g=M(n,-1),b=k[g]=B[g](n),{c(){s=A(),o=E("div"),c=E("img"),i=A(),u=E("div"),r=E("h1"),l=Y(n[0]),f=A(),h=E("h2"),a=Y(n[1]),m=A(),b.c(),this.h()},l(e){le("svelte-1kuv545",H.head).forEach(j),s=C(e),o=U(e,"DIV",{class:!0});var d=q(o);c=U(d,"IMG",{src:!0,alt:!0,style:!0}),i=C(d),u=U(d,"DIV",{class:!0});var y=q(u);r=U(y,"H1",{class:!0});var N=q(r);l=X(N,n[0]),N.forEach(j),f=C(y),h=U(y,"H2",{class:!0});var G=q(h);a=X(G,n[1]),G.forEach(j),y.forEach(j),m=C(d),b.l(d),d.forEach(j),this.h()},h(){ae(c.src,_="https://src.hazelnut-paradise.com/GooMapReviewSnatcher.png")||I(c,"src",_),I(c,"alt","GooMapReviewSnatcher"),W(c,"width","100%"),W(c,"max-width","150px"),I(r,"class","title svelte-fc3bky"),I(h,"class","subtitle svelte-fc3bky"),I(u,"class","title-box svelte-fc3bky"),I(o,"class","container svelte-fc3bky")},m(e,p){Q(e,s,p),Q(e,o,p),v(o,c),v(o,i),v(o,u),v(u,r),v(r,l),v(u,f),v(u,h),v(h,a),v(o,m),k[g].m(o,null),S=!0},p(e,[p]){(!S||p&1)&&t!==(t=e[0]+" - 榛果繽紛樂")&&(H.title=t),(!S||p&1)&&P(l,e[0]),(!S||p&2)&&P(a,e[1]);let d=g;g=M(e,p),g===d?k[g].p(e,p):(ue(),O(k[d],1,1,()=>{k[d]=null}),oe(),b=k[g],b?b.p(e,p):(b=k[g]=B[g](e),b.c()),F(b,1),b.m(o,null))},i(e){S||(F(b),S=!0)},o(e){O(b),S=!1},d(e){e&&(j(s),j(o)),k[g].d()}}}const we="/api/search",ke="/api/reviews";function Se(n,t,s){let{title:o}=t,{subtitle:c}=t,_="",i="",u=1,r=[],l=[],f=!1;const h=()=>{s(2,_=""),s(3,i=""),s(4,u=1),s(5,r=[]),s(6,l=[])},a=async()=>{if(s(7,f=!0),console.log(_),_===""){alert("請輸入搜尋關鍵字"),s(7,f=!1);return}try{const e=await fetch(we+`?storeName=${_}`);if(!e.ok){console.error("Error:",e.statusText),alert("無法取得搜尋結果");return}s(5,r=await e.json()),console.log(r)}catch(e){console.error(e),alert("無法取得搜尋結果")}finally{s(7,f=!1)}},m=async()=>{if(s(7,f=!0),console.log(i),i===""){alert("請選擇店家"),s(7,f=!1);return}try{const e=await fetch(ke+`?storeID=${i.ID}&pages=${u}`);if(!e.ok){console.error("Error:",e.statusText),alert("無法取得評論");return}s(6,l=await e.json()),console.log(l)}catch(e){console.error(e),alert("無法取得評論")}finally{s(7,f=!1)}},w=e=>{const p=document.createElement("a");let d="";switch(e){case"csv":const y=new Uint8Array([239,187,191]),N=Object.keys(l[0]).join(","),G=l.map(te=>Object.values(te).map(D=>typeof D=="string"&&(D.includes(",")||D.includes(`
`)||D.includes('"'))?`"${D.replace(/"/g,'""')}"`:D).join(",")),Z=N+`
`+G.join(`
`),$=new Blob([y,Z],{type:"text/csv;charset=utf-8"});d=window.URL.createObjectURL($),p.href=d,p.download=`${i.Name}.csv`,p.click();break;case"json":const x=JSON.stringify(l,null,2),ee=new Blob([x],{type:"application/json;charset=utf-8"});d=window.URL.createObjectURL(ee),p.href=d,p.download=`${i.Name}.json`,p.click();break}window.URL.revokeObjectURL(d)};ce(async()=>{getNavbar()});function g(e){_=e,s(2,_)}function b(e){i=e,s(3,i)}function S(e){r=e,s(5,r)}function B(e){u=e,s(4,u)}function k(e){r=e,s(5,r)}function M(e){l=e,s(6,l)}return n.$$set=e=>{"title"in e&&s(0,o=e.title),"subtitle"in e&&s(1,c=e.subtitle)},[o,c,_,i,u,r,l,f,h,a,m,w,g,b,S,B,k,M]}class Te extends se{constructor(t){super(),ne(this,t,Se,me,re,{title:0,subtitle:1})}}export{Te as default};
