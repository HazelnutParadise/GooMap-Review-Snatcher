import{S as ve,i as be,s as ge,d as b,t as Y,b as P,r as q,e as me,h as M,u as d,D as we,v as I,E as re,F as ke,z as G,w as y,x as C,y as J,C as H,A as z,B as K,q as je,o as ee,a as fe,m as _e,j as de,f as pe,G as Q,H as W,I as X,J as te,K as Se,L as Z,M as x,g as Te}from"../chunks/index-BJqTltJS.js";import{I as Ee,e as V}from"../chunks/InputCard-Iku7P7r-.js";import ye from"./Loader-Fr5qsQQS.js";import"./InfoCard-tt4j3H1B.js";const ze=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,{document:$}=ze;function oe(r,e,s){const l=r.slice();return l[17]=e[s],l}function ae(r,e,s){const l=r.slice();return l[20]=e[s],l}function ce(r,e,s){const l=r.slice();return l[23]=e[s],l}function Ie(r){let e,s="查詢其他商家",l,t,n,f=r[3].Name+"",o,j,_,i="下載 CSV",T,m,N="下載 JSON",F,w,v,O,D,B,u,h,k,E=V(Object.keys(r[6][0])),p=[];for(let c=0;c<E.length;c+=1)p[c]=ie(ce(r,E,c));let R=V(r[6]),g=[];for(let c=0;c<R.length;c+=1)g[c]=he(oe(r,R,c));return{c(){e=z("button"),e.textContent=s,l=H(),t=z("div"),n=z("h3"),o=K(f),j=H(),_=z("button"),_.textContent=i,T=H(),m=z("button"),m.textContent=N,F=H(),w=z("div"),v=z("table"),O=z("thead"),D=z("tr");for(let c=0;c<p.length;c+=1)p[c].c();B=H(),u=z("tbody");for(let c=0;c<g.length;c+=1)g[c].c();this.h()},l(c){e=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),x(e)!=="svelte-gc4oaf"&&(e.textContent=s),l=G(c),t=y(c,"DIV",{class:!0});var S=C(t);n=y(S,"H3",{class:!0});var a=C(n);o=J(a,f),a.forEach(b),j=G(S),_=y(S,"BUTTON",{class:!0,"data-svelte-h":!0}),x(_)!=="svelte-1cm302j"&&(_.textContent=i),T=G(S),m=y(S,"BUTTON",{class:!0,"data-svelte-h":!0}),x(m)!=="svelte-zkdu87"&&(m.textContent=N),F=G(S),w=y(S,"DIV",{class:!0});var L=C(w);v=y(L,"TABLE",{class:!0});var U=C(v);O=y(U,"THEAD",{});var le=C(O);D=y(le,"TR",{class:!0});var se=C(D);for(let A=0;A<p.length;A+=1)p[A].l(se);se.forEach(b),le.forEach(b),B=G(U),u=y(U,"TBODY",{});var ne=C(u);for(let A=0;A<g.length;A+=1)g[A].l(ne);ne.forEach(b),U.forEach(b),L.forEach(b),S.forEach(b),this.h()},h(){I(e,"class","reset-button button svelte-zppriv"),I(n,"class","store-name svelte-zppriv"),I(_,"class","download-button button svelte-zppriv"),I(m,"class","download-button button svelte-zppriv"),I(D,"class","svelte-zppriv"),I(v,"class","review-table svelte-zppriv"),I(w,"class","review-table-box svelte-zppriv"),I(t,"class","review-box svelte-zppriv")},m(c,S){M(c,e,S),M(c,l,S),M(c,t,S),d(t,n),d(n,o),d(t,j),d(t,_),d(t,T),d(t,m),d(t,F),d(t,w),d(w,v),d(v,O),d(O,D);for(let a=0;a<p.length;a+=1)p[a]&&p[a].m(D,null);d(v,B),d(v,u);for(let a=0;a<g.length;a+=1)g[a]&&g[a].m(u,null);h||(k=[Z(e,"click",r[14]),Z(_,"click",r[15]),Z(m,"click",r[16])],h=!0)},p(c,S){if(S&8&&f!==(f=c[3].Name+"")&&q(o,f),S&64){E=V(Object.keys(c[6][0]));let a;for(a=0;a<E.length;a+=1){const L=ce(c,E,a);p[a]?p[a].p(L,S):(p[a]=ie(L),p[a].c(),p[a].m(D,null))}for(;a<p.length;a+=1)p[a].d(1);p.length=E.length}if(S&64){R=V(c[6]);let a;for(a=0;a<R.length;a+=1){const L=oe(c,R,a);g[a]?g[a].p(L,S):(g[a]=he(L),g[a].c(),g[a].m(u,null))}for(;a<g.length;a+=1)g[a].d(1);g.length=R.length}},i:ee,o:ee,d(c){c&&(b(e),b(l),b(t)),te(p,c),te(g,c),h=!1,Se(k)}}}function Oe(r){let e,s,l,t,n;function f(i){r[11](i)}function o(i){r[12](i)}function j(i){r[13](i)}let _={handleSearch:r[8],handleGetReview:r[9],storeData:r[5]};return r[4]!==void 0&&(_.pagesToFetch=r[4]),r[2]!==void 0&&(_.searchInputStr=r[2]),r[3]!==void 0&&(_.selectedStore=r[3]),e=new Ee({props:_}),Q.push(()=>W(e,"pagesToFetch",f)),Q.push(()=>W(e,"searchInputStr",o)),Q.push(()=>W(e,"selectedStore",j)),{c(){pe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,T){_e(e,i,T),n=!0},p(i,T){const m={};T&32&&(m.storeData=i[5]),!s&&T&16&&(s=!0,m.pagesToFetch=i[4],X(()=>s=!1)),!l&&T&4&&(l=!0,m.searchInputStr=i[2],X(()=>l=!1)),!t&&T&8&&(t=!0,m.selectedStore=i[3],X(()=>t=!1)),e.$set(m)},i(i){n||(P(e.$$.fragment,i),n=!0)},o(i){Y(e.$$.fragment,i),n=!1},d(i){fe(e,i)}}}function Be(r){let e,s;return e=new ye({}),{c(){pe(e.$$.fragment)},l(l){de(e.$$.fragment,l)},m(l,t){_e(e,l,t),s=!0},p:ee,i(l){s||(P(e.$$.fragment,l),s=!0)},o(l){Y(e.$$.fragment,l),s=!1},d(l){fe(e,l)}}}function ie(r){let e,s=r[23]+"",l;return{c(){e=z("th"),l=K(s),this.h()},l(t){e=y(t,"TH",{class:!0});var n=C(e);l=J(n,s),n.forEach(b),this.h()},h(){I(e,"class","svelte-zppriv")},m(t,n){M(t,e,n),d(e,l)},p(t,n){n&64&&s!==(s=t[23]+"")&&q(l,s)},d(t){t&&b(e)}}}function ue(r){let e,s=r[20]+"",l;return{c(){e=z("td"),l=K(s),this.h()},l(t){e=y(t,"TD",{class:!0});var n=C(e);l=J(n,s),n.forEach(b),this.h()},h(){I(e,"class","svelte-zppriv")},m(t,n){M(t,e,n),d(e,l)},p(t,n){n&64&&s!==(s=t[20]+"")&&q(l,s)},d(t){t&&b(e)}}}function he(r){let e,s,l=V(Object.values(r[17])),t=[];for(let n=0;n<l.length;n+=1)t[n]=ue(ae(r,l,n));return{c(){e=z("tr");for(let n=0;n<t.length;n+=1)t[n].c();s=H(),this.h()},l(n){e=y(n,"TR",{class:!0});var f=C(e);for(let o=0;o<t.length;o+=1)t[o].l(f);s=G(f),f.forEach(b),this.h()},h(){I(e,"class","svelte-zppriv")},m(n,f){M(n,e,f);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null);d(e,s)},p(n,f){if(f&64){l=V(Object.values(n[17]));let o;for(o=0;o<l.length;o+=1){const j=ae(n,l,o);t[o]?t[o].p(j,f):(t[o]=ue(j),t[o].c(),t[o].m(e,s))}for(;o<t.length;o+=1)t[o].d(1);t.length=l.length}},d(n){n&&b(e),te(t,n)}}}function Ce(r){let e,s,l,t,n,f,o,j,_,i,T,m,N,F,w,v,O;$.title=e=r[0]+" - 榛果繽紛樂";const D=[Be,Oe,Ie],B=[];function u(h,k){return k&64&&(F=null),h[7]?0:(F==null&&(F=Object.keys(h[6]).length==0),F?1:2)}return w=u(r,-1),v=B[w]=D[w](r),{c(){s=H(),l=z("div"),t=z("img"),f=H(),o=z("div"),j=z("h1"),_=K(r[0]),i=H(),T=z("h2"),m=K(r[1]),N=H(),v.c(),this.h()},l(h){ke("svelte-wrcujp",$.head).forEach(b),s=G(h),l=y(h,"DIV",{class:!0});var E=C(l);t=y(E,"IMG",{src:!0,alt:!0,style:!0}),f=G(E),o=y(E,"DIV",{class:!0});var p=C(o);j=y(p,"H1",{class:!0});var R=C(j);_=J(R,r[0]),R.forEach(b),i=G(p),T=y(p,"H2",{class:!0});var g=C(T);m=J(g,r[1]),g.forEach(b),p.forEach(b),N=G(E),v.l(E),E.forEach(b),this.h()},h(){we(t.src,n="https://src.hazelnut-paradise.com/GooMapReviewSnatcher.png")||I(t,"src",n),I(t,"alt","GooMapReviewSnatcher"),re(t,"width","100%"),re(t,"max-width","150px"),I(j,"class","title svelte-zppriv"),I(T,"class","subtitle svelte-zppriv"),I(o,"class","title-box svelte-zppriv"),I(l,"class","container svelte-zppriv")},m(h,k){M(h,s,k),M(h,l,k),d(l,t),d(l,f),d(l,o),d(o,j),d(j,_),d(o,i),d(o,T),d(T,m),d(l,N),B[w].m(l,null),O=!0},p(h,[k]){(!O||k&1)&&e!==(e=h[0]+" - 榛果繽紛樂")&&($.title=e),(!O||k&1)&&q(_,h[0]),(!O||k&2)&&q(m,h[1]);let E=w;w=u(h,k),w===E?B[w].p(h,k):(Te(),Y(B[E],1,1,()=>{B[E]=null}),me(),v=B[w],v?v.p(h,k):(v=B[w]=D[w](h),v.c()),P(v,1),v.m(l,null))},i(h){O||(P(v),O=!0)},o(h){Y(v),O=!1},d(h){h&&(b(s),b(l)),B[w].d()}}}const De="/api/search",Re="/api/reviews";function Ue(r,e,s){let{title:l}=e,{subtitle:t}=e,n="",f="",o=1,j=[],_=[],i=!1;const T=async()=>{if(s(7,i=!0),console.log(n),n===""){alert("請輸入搜尋關鍵字"),s(7,i=!1);return}try{const u=await fetch(De+`?storeName=${n}`);if(!u.ok){console.error("Error:",u.statusText),alert("無法取得搜尋結果");return}s(5,j=await u.json()),console.log(j)}catch(u){console.error(u),alert("無法取得搜尋結果")}finally{s(7,i=!1)}},m=async()=>{if(s(7,i=!0),console.log(f),f===""){alert("請選擇店家"),s(7,i=!1);return}try{const u=await fetch(Re+`?storeID=${f.ID}&pages=${o}`);if(!u.ok){console.error("Error:",u.statusText),alert("無法取得評論");return}s(6,_=await u.json()),console.log(_)}catch(u){console.error(u),alert("無法取得評論")}finally{s(7,i=!1)}},N=u=>{const h=document.createElement("a");let k="";switch(u){case"csv":const E=new Uint8Array([239,187,191]),p=Object.keys(_[0]).join(","),R=_.map(L=>Object.values(L).map(U=>typeof U=="string"&&(U.includes(",")||U.includes(`
`)||U.includes('"'))?`"${U.replace(/"/g,'""')}"`:U).join(",")),g=p+`
`+R.join(`
`),c=new Blob([E,g],{type:"text/csv;charset=utf-8"});k=window.URL.createObjectURL(c),h.href=k,h.download=`${f.Name}.csv`,h.click();break;case"json":const S=JSON.stringify(_,null,2),a=new Blob([S],{type:"application/json;charset=utf-8"});k=window.URL.createObjectURL(a),h.href=k,h.download=`${f.Name}.json`,h.click();break}window.URL.revokeObjectURL(k)};je(async()=>{getNavbar()});function F(u){o=u,s(4,o)}function w(u){n=u,s(2,n)}function v(u){f=u,s(3,f)}const O=()=>{s(2,n=""),s(5,j=[]),s(6,_=[])},D=()=>N("csv"),B=()=>N("json");return r.$$set=u=>{"title"in u&&s(0,l=u.title),"subtitle"in u&&s(1,t=u.subtitle)},[l,t,n,f,o,j,_,i,T,m,N,F,w,v,O,D,B]}class He extends ve{constructor(e){super(),be(this,e,Ue,Ce,ge,{title:0,subtitle:1})}}export{He as default};
