import{S as ge,i as be,s as ve,d as _,t as W,b as X,r as K,e as me,h as R,u as b,v as j,D as M,E as we,F as ke,z as F,w,x as C,y as P,G as Q,C as N,A as k,B as Y,q as Ee,o as se,a as fe,m as _e,j as de,f as pe,H as Z,I as $,J as ee,K as ne,L as Te,M as te,g as je}from"../chunks/index-CxwuwH1G.js";import{I as Se,e as z}from"../chunks/InputCard-LFjYBZrF.js";import ye from"./Loader-CuxEN0jw.js";import"./InfoCard-DuMYciqN.js";const Ie=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,{document:le}=Ie;function re(a,e,o){const n=a.slice();return n[17]=e[o],n}function ae(a,e,o){const n=a.slice();return n[20]=e[o],n}function ce(a,e,o){const n=a.slice();return n[23]=e[o],n}function Oe(a){let e,o="查詢其他商家",n,l,t,f=a[3].Name+"",h,S,d,u="下載 CSV",y,E,U="下載 JSON",G,L,D,T,v,H,c,B,I,V=z(Object.keys(a[6][0])),g=[];for(let i=0;i<V.length;i+=1)g[i]=ie(ce(a,V,i));let A=z(a[6]),p=[];for(let i=0;i<A.length;i+=1)p[i]=he(re(a,A,i));return{c(){e=k("button"),e.textContent=o,n=N(),l=k("div"),t=k("h3"),h=Y(f),S=N(),d=k("button"),d.textContent=u,y=N(),E=k("button"),E.textContent=U,G=N(),L=k("div"),D=k("table"),T=k("thead"),v=k("tr");for(let i=0;i<g.length;i+=1)g[i].c();H=N(),c=k("tbody");for(let i=0;i<p.length;i+=1)p[i].c();this.h()},l(i){e=w(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-gc4oaf"&&(e.textContent=o),n=F(i),l=w(i,"DIV",{class:!0});var r=C(l);t=w(r,"H3",{class:!0});var s=C(t);h=P(s,f),s.forEach(_),S=F(r),d=w(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(d)!=="svelte-1cm302j"&&(d.textContent=u),y=F(r),E=w(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(E)!=="svelte-zkdu87"&&(E.textContent=U),G=F(r),L=w(r,"DIV",{class:!0});var m=C(L);D=w(m,"TABLE",{class:!0});var O=C(D);T=w(O,"THEAD",{});var q=C(T);v=w(q,"TR",{class:!0});var J=C(v);for(let x=0;x<g.length;x+=1)g[x].l(J);J.forEach(_),q.forEach(_),H=F(O),c=w(O,"TBODY",{});var oe=C(c);for(let x=0;x<p.length;x+=1)p[x].l(oe);oe.forEach(_),O.forEach(_),m.forEach(_),r.forEach(_),this.h()},h(){j(e,"class","reset-button button svelte-1g7cuhe"),j(t,"class","store-name svelte-1g7cuhe"),j(d,"class","download-button button svelte-1g7cuhe"),j(E,"class","download-button button svelte-1g7cuhe"),j(v,"class","svelte-1g7cuhe"),j(D,"class","review-table svelte-1g7cuhe"),j(L,"class","review-table-box svelte-1g7cuhe"),j(l,"class","review-box svelte-1g7cuhe")},m(i,r){R(i,e,r),R(i,n,r),R(i,l,r),b(l,t),b(t,h),b(l,S),b(l,d),b(l,y),b(l,E),b(l,G),b(l,L),b(L,D),b(D,T),b(T,v);for(let s=0;s<g.length;s+=1)g[s]&&g[s].m(v,null);b(D,H),b(D,c);for(let s=0;s<p.length;s+=1)p[s]&&p[s].m(c,null);B||(I=[te(e,"click",a[14]),te(d,"click",a[15]),te(E,"click",a[16])],B=!0)},p(i,r){if(r&8&&f!==(f=i[3].Name+"")&&K(h,f),r&64){V=z(Object.keys(i[6][0]));let s;for(s=0;s<V.length;s+=1){const m=ce(i,V,s);g[s]?g[s].p(m,r):(g[s]=ie(m),g[s].c(),g[s].m(v,null))}for(;s<g.length;s+=1)g[s].d(1);g.length=V.length}if(r&64){A=z(i[6]);let s;for(s=0;s<A.length;s+=1){const m=re(i,A,s);p[s]?p[s].p(m,r):(p[s]=he(m),p[s].c(),p[s].m(c,null))}for(;s<p.length;s+=1)p[s].d(1);p.length=A.length}},i:se,o:se,d(i){i&&(_(e),_(n),_(l)),ne(g,i),ne(p,i),B=!1,Te(I)}}}function Ce(a){let e,o,n,l,t;function f(u){a[11](u)}function h(u){a[12](u)}function S(u){a[13](u)}let d={handleSearch:a[8],handleGetReview:a[9],storeData:a[5]};return a[4]!==void 0&&(d.pagesToFetch=a[4]),a[2]!==void 0&&(d.searchInputStr=a[2]),a[3]!==void 0&&(d.selectedStore=a[3]),e=new Se({props:d}),Z.push(()=>$(e,"pagesToFetch",f)),Z.push(()=>$(e,"searchInputStr",h)),Z.push(()=>$(e,"selectedStore",S)),{c(){pe(e.$$.fragment)},l(u){de(e.$$.fragment,u)},m(u,y){_e(e,u,y),t=!0},p(u,y){const E={};y&32&&(E.storeData=u[5]),!o&&y&16&&(o=!0,E.pagesToFetch=u[4],ee(()=>o=!1)),!n&&y&4&&(n=!0,E.searchInputStr=u[2],ee(()=>n=!1)),!l&&y&8&&(l=!0,E.selectedStore=u[3],ee(()=>l=!1)),e.$set(E)},i(u){t||(X(e.$$.fragment,u),t=!0)},o(u){W(e.$$.fragment,u),t=!1},d(u){fe(e,u)}}}function De(a){let e,o;return e=new ye({}),{c(){pe(e.$$.fragment)},l(n){de(e.$$.fragment,n)},m(n,l){_e(e,n,l),o=!0},p:se,i(n){o||(X(e.$$.fragment,n),o=!0)},o(n){W(e.$$.fragment,n),o=!1},d(n){fe(e,n)}}}function ie(a){let e,o=a[23]+"",n;return{c(){e=k("th"),n=Y(o),this.h()},l(l){e=w(l,"TH",{class:!0});var t=C(e);n=P(t,o),t.forEach(_),this.h()},h(){j(e,"class","svelte-1g7cuhe")},m(l,t){R(l,e,t),b(e,n)},p(l,t){t&64&&o!==(o=l[23]+"")&&K(n,o)},d(l){l&&_(e)}}}function ue(a){let e,o=a[20]+"",n;return{c(){e=k("td"),n=Y(o),this.h()},l(l){e=w(l,"TD",{class:!0});var t=C(e);n=P(t,o),t.forEach(_),this.h()},h(){j(e,"class","svelte-1g7cuhe")},m(l,t){R(l,e,t),b(e,n)},p(l,t){t&64&&o!==(o=l[20]+"")&&K(n,o)},d(l){l&&_(e)}}}function he(a){let e,o,n=z(Object.values(a[17])),l=[];for(let t=0;t<n.length;t+=1)l[t]=ue(ae(a,n,t));return{c(){e=k("tr");for(let t=0;t<l.length;t+=1)l[t].c();o=N(),this.h()},l(t){e=w(t,"TR",{class:!0});var f=C(e);for(let h=0;h<l.length;h+=1)l[h].l(f);o=F(f),f.forEach(_),this.h()},h(){j(e,"class","svelte-1g7cuhe")},m(t,f){R(t,e,f);for(let h=0;h<l.length;h+=1)l[h]&&l[h].m(e,null);b(e,o)},p(t,f){if(f&64){n=z(Object.values(t[17]));let h;for(h=0;h<n.length;h+=1){const S=ae(t,n,h);l[h]?l[h].p(S,f):(l[h]=ue(S),l[h].c(),l[h].m(e,o))}for(;h<l.length;h+=1)l[h].d(1);l.length=n.length}},d(t){t&&_(e),ne(l,t)}}}function Be(a){let e,o,n,l,t,f,h,S,d,u,y,E,U,G,L,D,T,v,H,c,B,I,V="2025 - 榛果繽紛樂",g;le.title=e=a[0]+" - 榛果繽紛樂";const A=[De,Ce,Oe],p=[];function i(r,s){return s&64&&(D=null),r[7]?0:(D==null&&(D=Object.keys(r[6]).length==0),D?1:2)}return T=i(a,-1),v=p[T]=A[T](a),{c(){o=N(),n=k("div"),l=N(),t=k("div"),f=k("img"),S=N(),d=k("div"),u=k("h1"),y=Y(a[0]),E=N(),U=k("h2"),G=Y(a[1]),L=N(),v.c(),H=N(),c=k("div"),B=N(),I=k("footer"),I.textContent=V,this.h()},l(r){ke("svelte-wrcujp",le.head).forEach(_),o=F(r),n=w(r,"DIV",{id:!0,style:!0}),C(n).forEach(_),l=F(r),t=w(r,"DIV",{class:!0});var m=C(t);f=w(m,"IMG",{src:!0,alt:!0,style:!0}),S=F(m),d=w(m,"DIV",{class:!0});var O=C(d);u=w(O,"H1",{class:!0});var q=C(u);y=P(q,a[0]),q.forEach(_),E=F(O),U=w(O,"H2",{class:!0});var J=C(U);G=P(J,a[1]),J.forEach(_),O.forEach(_),L=F(m),v.l(m),m.forEach(_),H=F(r),c=w(r,"DIV",{id:!0,style:!0}),C(c).forEach(_),B=F(r),I=w(r,"FOOTER",{class:!0,"data-svelte-h":!0}),Q(I)!=="svelte-livmhd"&&(I.textContent=V),this.h()},h(){j(n,"id","Pistachio-Announcement"),M(n,"display","fixed"),M(n,"top","20px"),M(n,"left","0"),M(n,"z-index","100"),we(f.src,h="https://src.hazelnut-paradise.com/GooMapReviewSnatcher.png")||j(f,"src",h),j(f,"alt","GooMapReviewSnatcher"),M(f,"width","100%"),M(f,"max-width","150px"),j(u,"class","title svelte-1g7cuhe"),j(U,"class","subtitle svelte-1g7cuhe"),j(d,"class","title-box svelte-1g7cuhe"),j(t,"class","container svelte-1g7cuhe"),j(c,"id","navbar-placeholder"),M(c,"height","50px"),M(c,"z-index","100"),j(I,"class","svelte-1g7cuhe")},m(r,s){R(r,o,s),R(r,n,s),R(r,l,s),R(r,t,s),b(t,f),b(t,S),b(t,d),b(d,u),b(u,y),b(d,E),b(d,U),b(U,G),b(t,L),p[T].m(t,null),R(r,H,s),R(r,c,s),R(r,B,s),R(r,I,s),g=!0},p(r,[s]){(!g||s&1)&&e!==(e=r[0]+" - 榛果繽紛樂")&&(le.title=e),(!g||s&1)&&K(y,r[0]),(!g||s&2)&&K(G,r[1]);let m=T;T=i(r,s),T===m?p[T].p(r,s):(je(),W(p[m],1,1,()=>{p[m]=null}),me(),v=p[T],v?v.p(r,s):(v=p[T]=A[T](r),v.c()),X(v,1),v.m(t,null))},i(r){g||(X(v),g=!0)},o(r){W(v),g=!1},d(r){r&&(_(o),_(n),_(l),_(t),_(H),_(c),_(B),_(I)),p[T].d()}}}const Re="/api/search",Ue="/api/reviews";function Fe(a,e,o){let{title:n}=e,{subtitle:l}=e,t="",f="",h=1,S=[],d=[],u=!1;const y=async()=>{if(o(7,u=!0),console.log(t),t===""){alert("請輸入搜尋關鍵字"),o(7,u=!1);return}try{const c=await fetch(Re+`?storeName=${t}`);if(!c.ok){console.error("Error:",c.statusText),alert("無法取得搜尋結果");return}o(5,S=await c.json()),console.log(S)}catch(c){console.error(c),alert("無法取得搜尋結果")}finally{o(7,u=!1)}},E=async()=>{if(o(7,u=!0),console.log(f),f===""){alert("請選擇店家"),o(7,u=!1);return}try{const c=await fetch(Ue+`?storeID=${f.ID}&pages=${h}`);if(!c.ok){console.error("Error:",c.statusText),alert("無法取得評論");return}o(6,d=await c.json()),console.log(d)}catch(c){console.error(c),alert("無法取得評論")}finally{o(7,u=!1)}},U=c=>{const B=document.createElement("a");let I="";switch(c){case"csv":const V=new Uint8Array([239,187,191]),g=Object.keys(d[0]).join(","),A=d.map(m=>Object.values(m).map(O=>typeof O=="string"&&(O.includes(",")||O.includes(`
`)||O.includes('"'))?`"${O.replace(/"/g,'""')}"`:O).join(",")),p=g+`
`+A.join(`
`),i=new Blob([V,p],{type:"text/csv;charset=utf-8"});I=window.URL.createObjectURL(i),B.href=I,B.download=`${f.Name}.csv`,B.click();break;case"json":const r=JSON.stringify(d,null,2),s=new Blob([r],{type:"application/json;charset=utf-8"});I=window.URL.createObjectURL(s),B.href=I,B.download=`${f.Name}.json`,B.click();break}window.URL.revokeObjectURL(I)};Ee(async()=>{getNavbar()});function G(c){h=c,o(4,h)}function L(c){t=c,o(2,t)}function D(c){f=c,o(3,f)}const T=()=>{o(2,t=""),o(5,S=[]),o(6,d=[])},v=()=>U("csv"),H=()=>U("json");return a.$$set=c=>{"title"in c&&o(0,n=c.title),"subtitle"in c&&o(1,l=c.subtitle)},[n,l,t,f,h,S,d,u,y,E,U,G,L,D,T,v,H]}class Ge extends ge{constructor(e){super(),be(this,e,Fe,Be,ve,{title:0,subtitle:1})}}export{Ge as default};
