import{S as pe,i as be,s as ge,d as f,t as W,b as X,r as K,e as me,h as R,u as p,v as E,D as Z,E as we,F as ke,z as A,w as C,x as y,y as P,G as Q,C as U,A as D,B as Y,q as Ce,o as se,a as fe,m as _e,j as de,f as ve,H as x,I as $,J as ee,K as ne,L as De,M as te,g as Ee}from"../chunks/index-CxwuwH1G.js";import{I as Te,e as q}from"../chunks/InputCard-DQwDkEWn.js";import je from"./Loader-CuxEN0jw.js";import"./InfoCard-COxViyc-.js";const Se=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,{document:le}=Se;function re(a,e,n){const o=a.slice();return o[17]=e[n],o}function ae(a,e,n){const o=a.slice();return o[20]=e[n],o}function ce(a,e,n){const o=a.slice();return o[23]=e[n],o}function ye(a){let e,n="查詢其他商家",o,t,l,_=a[3].Name+"",c,m,b,h="下載 CSV",w,g,N="下載 JSON",H,B,I,L,F,T,i,O,j,V=q(Object.keys(a[6][0])),v=[];for(let u=0;u<V.length;u+=1)v[u]=ie(ce(a,V,u));let G=q(a[6]),d=[];for(let u=0;u<G.length;u+=1)d[u]=he(re(a,G,u));return{c(){e=D("button"),e.textContent=n,o=U(),t=D("div"),l=D("h3"),c=Y(_),m=U(),b=D("button"),b.textContent=h,w=U(),g=D("button"),g.textContent=N,H=U(),B=D("div"),I=D("table"),L=D("thead"),F=D("tr");for(let u=0;u<v.length;u+=1)v[u].c();T=U(),i=D("tbody");for(let u=0;u<d.length;u+=1)d[u].c();this.h()},l(u){e=C(u,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(e)!=="svelte-gc4oaf"&&(e.textContent=n),o=A(u),t=C(u,"DIV",{class:!0});var r=y(t);l=C(r,"H3",{class:!0});var s=y(l);c=P(s,_),s.forEach(f),m=A(r),b=C(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(b)!=="svelte-1cm302j"&&(b.textContent=h),w=A(r),g=C(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(g)!=="svelte-zkdu87"&&(g.textContent=N),H=A(r),B=C(r,"DIV",{class:!0});var k=y(B);I=C(k,"TABLE",{class:!0});var S=y(I);L=C(S,"THEAD",{});var z=y(L);F=C(z,"TR",{class:!0});var J=y(F);for(let M=0;M<v.length;M+=1)v[M].l(J);J.forEach(f),z.forEach(f),T=A(S),i=C(S,"TBODY",{});var oe=y(i);for(let M=0;M<d.length;M+=1)d[M].l(oe);oe.forEach(f),S.forEach(f),k.forEach(f),r.forEach(f),this.h()},h(){E(e,"class","reset-button button svelte-12wvi4t"),E(l,"class","store-name svelte-12wvi4t"),E(b,"class","download-button button svelte-12wvi4t"),E(g,"class","download-button button svelte-12wvi4t"),E(F,"class","svelte-12wvi4t"),E(I,"class","review-table svelte-12wvi4t"),E(B,"class","review-table-box svelte-12wvi4t"),E(t,"class","review-box svelte-12wvi4t")},m(u,r){R(u,e,r),R(u,o,r),R(u,t,r),p(t,l),p(l,c),p(t,m),p(t,b),p(t,w),p(t,g),p(t,H),p(t,B),p(B,I),p(I,L),p(L,F);for(let s=0;s<v.length;s+=1)v[s]&&v[s].m(F,null);p(I,T),p(I,i);for(let s=0;s<d.length;s+=1)d[s]&&d[s].m(i,null);O||(j=[te(e,"click",a[14]),te(b,"click",a[15]),te(g,"click",a[16])],O=!0)},p(u,r){if(r&8&&_!==(_=u[3].Name+"")&&K(c,_),r&64){V=q(Object.keys(u[6][0]));let s;for(s=0;s<V.length;s+=1){const k=ce(u,V,s);v[s]?v[s].p(k,r):(v[s]=ie(k),v[s].c(),v[s].m(F,null))}for(;s<v.length;s+=1)v[s].d(1);v.length=V.length}if(r&64){G=q(u[6]);let s;for(s=0;s<G.length;s+=1){const k=re(u,G,s);d[s]?d[s].p(k,r):(d[s]=he(k),d[s].c(),d[s].m(i,null))}for(;s<d.length;s+=1)d[s].d(1);d.length=G.length}},i:se,o:se,d(u){u&&(f(e),f(o),f(t)),ne(v,u),ne(d,u),O=!1,De(j)}}}function Be(a){let e,n,o,t,l;function _(h){a[11](h)}function c(h){a[12](h)}function m(h){a[13](h)}let b={handleSearch:a[8],handleGetReview:a[9],storeData:a[5]};return a[4]!==void 0&&(b.pagesToFetch=a[4]),a[2]!==void 0&&(b.searchInputStr=a[2]),a[3]!==void 0&&(b.selectedStore=a[3]),e=new Te({props:b}),x.push(()=>$(e,"pagesToFetch",_)),x.push(()=>$(e,"searchInputStr",c)),x.push(()=>$(e,"selectedStore",m)),{c(){ve(e.$$.fragment)},l(h){de(e.$$.fragment,h)},m(h,w){_e(e,h,w),l=!0},p(h,w){const g={};w&32&&(g.storeData=h[5]),!n&&w&16&&(n=!0,g.pagesToFetch=h[4],ee(()=>n=!1)),!o&&w&4&&(o=!0,g.searchInputStr=h[2],ee(()=>o=!1)),!t&&w&8&&(t=!0,g.selectedStore=h[3],ee(()=>t=!1)),e.$set(g)},i(h){l||(X(e.$$.fragment,h),l=!0)},o(h){W(e.$$.fragment,h),l=!1},d(h){fe(e,h)}}}function Ie(a){let e,n;return e=new je({}),{c(){ve(e.$$.fragment)},l(o){de(e.$$.fragment,o)},m(o,t){_e(e,o,t),n=!0},p:se,i(o){n||(X(e.$$.fragment,o),n=!0)},o(o){W(e.$$.fragment,o),n=!1},d(o){fe(e,o)}}}function ie(a){let e,n=a[23]+"",o;return{c(){e=D("th"),o=Y(n),this.h()},l(t){e=C(t,"TH",{class:!0});var l=y(e);o=P(l,n),l.forEach(f),this.h()},h(){E(e,"class","svelte-12wvi4t")},m(t,l){R(t,e,l),p(e,o)},p(t,l){l&64&&n!==(n=t[23]+"")&&K(o,n)},d(t){t&&f(e)}}}function ue(a){let e,n=a[20]+"",o;return{c(){e=D("td"),o=Y(n),this.h()},l(t){e=C(t,"TD",{class:!0});var l=y(e);o=P(l,n),l.forEach(f),this.h()},h(){E(e,"class","svelte-12wvi4t")},m(t,l){R(t,e,l),p(e,o)},p(t,l){l&64&&n!==(n=t[20]+"")&&K(o,n)},d(t){t&&f(e)}}}function he(a){let e,n,o=q(Object.values(a[17])),t=[];for(let l=0;l<o.length;l+=1)t[l]=ue(ae(a,o,l));return{c(){e=D("tr");for(let l=0;l<t.length;l+=1)t[l].c();n=U(),this.h()},l(l){e=C(l,"TR",{class:!0});var _=y(e);for(let c=0;c<t.length;c+=1)t[c].l(_);n=A(_),_.forEach(f),this.h()},h(){E(e,"class","svelte-12wvi4t")},m(l,_){R(l,e,_);for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(e,null);p(e,n)},p(l,_){if(_&64){o=q(Object.values(l[17]));let c;for(c=0;c<o.length;c+=1){const m=ae(l,o,c);t[c]?t[c].p(m,_):(t[c]=ue(m),t[c].c(),t[c].m(e,n))}for(;c<t.length;c+=1)t[c].d(1);t.length=o.length}},d(l){l&&f(e),ne(t,l)}}}function Oe(a){let e,n,o,t,l,_,c,m,b,h,w,g,N,H,B,I,L,F,T,i,O,j,V="2025 - 榛果繽紛樂",v;le.title=e=a[0]+" - 榛果繽紛樂";const G=[Ie,Be,ye],d=[];function u(r,s){return s&64&&(F=null),r[7]?0:(F==null&&(F=Object.keys(r[6]).length==0),F?1:2)}return T=u(a,-1),i=d[T]=G[T](a),{c(){n=U(),o=D("div"),t=U(),l=D("div"),_=U(),c=D("div"),m=D("img"),h=U(),w=D("div"),g=D("h1"),N=Y(a[0]),H=U(),B=D("h2"),I=Y(a[1]),L=U(),i.c(),O=U(),j=D("footer"),j.textContent=V,this.h()},l(r){ke("svelte-wrcujp",le.head).forEach(f),n=A(r),o=C(r,"DIV",{id:!0,style:!0}),y(o).forEach(f),t=A(r),l=C(r,"DIV",{id:!0}),y(l).forEach(f),_=A(r),c=C(r,"DIV",{class:!0});var k=y(c);m=C(k,"IMG",{src:!0,alt:!0,style:!0}),h=A(k),w=C(k,"DIV",{class:!0});var S=y(w);g=C(S,"H1",{class:!0});var z=y(g);N=P(z,a[0]),z.forEach(f),H=A(S),B=C(S,"H2",{class:!0});var J=y(B);I=P(J,a[1]),J.forEach(f),S.forEach(f),L=A(k),i.l(k),k.forEach(f),O=A(r),j=C(r,"FOOTER",{class:!0,"data-svelte-h":!0}),Q(j)!=="svelte-livmhd"&&(j.textContent=V),this.h()},h(){E(o,"id","navbar-placeholder"),Z(o,"height","50px"),E(l,"id","Pistachio-Announcement"),we(m.src,b="https://src.hazelnut-paradise.com/GooMapReviewSnatcher.png")||E(m,"src",b),E(m,"alt","GooMapReviewSnatcher"),Z(m,"width","100%"),Z(m,"max-width","150px"),E(g,"class","title svelte-12wvi4t"),E(B,"class","subtitle svelte-12wvi4t"),E(w,"class","title-box svelte-12wvi4t"),E(c,"class","container svelte-12wvi4t"),E(j,"class","svelte-12wvi4t")},m(r,s){R(r,n,s),R(r,o,s),R(r,t,s),R(r,l,s),R(r,_,s),R(r,c,s),p(c,m),p(c,h),p(c,w),p(w,g),p(g,N),p(w,H),p(w,B),p(B,I),p(c,L),d[T].m(c,null),R(r,O,s),R(r,j,s),v=!0},p(r,[s]){(!v||s&1)&&e!==(e=r[0]+" - 榛果繽紛樂")&&(le.title=e),(!v||s&1)&&K(N,r[0]),(!v||s&2)&&K(I,r[1]);let k=T;T=u(r,s),T===k?d[T].p(r,s):(Ee(),W(d[k],1,1,()=>{d[k]=null}),me(),i=d[T],i?i.p(r,s):(i=d[T]=G[T](r),i.c()),X(i,1),i.m(c,null))},i(r){v||(X(i),v=!0)},o(r){W(i),v=!1},d(r){r&&(f(n),f(o),f(t),f(l),f(_),f(c),f(O),f(j)),d[T].d()}}}const Fe="/api/search",Re="/api/reviews";function Ae(a,e,n){let{title:o}=e,{subtitle:t}=e,l="",_="",c=1,m=[],b=[],h=!1;const w=async()=>{if(n(7,h=!0),console.log(l),l===""){alert("請輸入搜尋關鍵字"),n(7,h=!1);return}try{const i=await fetch(Fe+`?storeName=${l}`);if(!i.ok){console.error("Error:",i.statusText),alert("無法取得搜尋結果");return}n(5,m=await i.json()),console.log(m)}catch(i){console.error(i),alert("無法取得搜尋結果")}finally{n(7,h=!1)}},g=async()=>{if(n(7,h=!0),console.log(_),_===""){alert("請選擇店家"),n(7,h=!1);return}try{const i=await fetch(Re+`?storeID=${_.ID}&pages=${c}`);if(!i.ok){console.error("Error:",i.statusText),alert("無法取得評論");return}n(6,b=await i.json()),console.log(b)}catch(i){console.error(i),alert("無法取得評論")}finally{n(7,h=!1)}},N=i=>{const O=document.createElement("a");let j="";switch(i){case"csv":const V=new Uint8Array([239,187,191]),v=Object.keys(b[0]).join(","),G=b.map(k=>Object.values(k).map(S=>typeof S=="string"&&(S.includes(",")||S.includes(`
`)||S.includes('"'))?`"${S.replace(/"/g,'""')}"`:S).join(",")),d=v+`
`+G.join(`
`),u=new Blob([V,d],{type:"text/csv;charset=utf-8"});j=window.URL.createObjectURL(u),O.href=j,O.download=`${_.Name}.csv`,O.click();break;case"json":const r=JSON.stringify(b,null,2),s=new Blob([r],{type:"application/json;charset=utf-8"});j=window.URL.createObjectURL(s),O.href=j,O.download=`${_.Name}.json`,O.click();break}window.URL.revokeObjectURL(j)};Ce(async()=>{getNavbar()});function H(i){c=i,n(4,c)}function B(i){l=i,n(2,l)}function I(i){_=i,n(3,_)}const L=()=>{n(2,l=""),n(5,m=[]),n(6,b=[])},F=()=>N("csv"),T=()=>N("json");return a.$$set=i=>{"title"in i&&n(0,o=i.title),"subtitle"in i&&n(1,t=i.subtitle)},[o,t,l,_,c,m,b,h,w,g,N,H,B,I,L,F,T]}class Ge extends pe{constructor(e){super(),be(this,e,Ae,Oe,ge,{title:0,subtitle:1})}}export{Ge as default};
