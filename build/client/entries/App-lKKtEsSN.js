import{S as pe,i as be,s as ge,d as p,t as P,b as Q,r as z,e as me,h as U,u as b,v as D,D as W,E as we,F as ke,z as A,w as k,x as y,y as J,G as Y,C as N,A as C,B as K,q as Ce,o as te,a as fe,m as _e,j as de,f as ve,H as X,I as Z,J as x,K as le,L as De,M as $,g as Te}from"../chunks/index-CxwuwH1G.js";import{I as je,e as q}from"../chunks/InputCard-DQwDkEWn.js";import Ee from"./Loader-CuxEN0jw.js";import"./InfoCard-COxViyc-.js";const Se=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,{document:ee}=Se;function re(a,e,s){const n=a.slice();return n[17]=e[s],n}function ae(a,e,s){const n=a.slice();return n[20]=e[s],n}function ce(a,e,s){const n=a.slice();return n[23]=e[s],n}function ye(a){let e,s="查詢其他商家",n,l,t,f=a[3].Name+"",h,T,d,u="下載 CSV",j,m,O="下載 JSON",H,R,S,w,g,M,i,I,E,L=q(Object.keys(a[6][0])),v=[];for(let o=0;o<L.length;o+=1)v[o]=ie(ce(a,L,o));let G=q(a[6]),r=[];for(let o=0;o<G.length;o+=1)r[o]=he(re(a,G,o));return{c(){e=C("button"),e.textContent=s,n=N(),l=C("div"),t=C("h3"),h=K(f),T=N(),d=C("button"),d.textContent=u,j=N(),m=C("button"),m.textContent=O,H=N(),R=C("div"),S=C("table"),w=C("thead"),g=C("tr");for(let o=0;o<v.length;o+=1)v[o].c();M=N(),i=C("tbody");for(let o=0;o<r.length;o+=1)r[o].c();this.h()},l(o){e=k(o,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-gc4oaf"&&(e.textContent=s),n=A(o),l=k(o,"DIV",{class:!0});var _=y(l);t=k(_,"H3",{class:!0});var c=y(t);h=J(c,f),c.forEach(p),T=A(_),d=k(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(d)!=="svelte-1cm302j"&&(d.textContent=u),j=A(_),m=k(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(m)!=="svelte-zkdu87"&&(m.textContent=O),H=A(_),R=k(_,"DIV",{class:!0});var F=y(R);S=k(F,"TABLE",{class:!0});var B=y(S);w=k(B,"THEAD",{});var se=y(w);g=k(se,"TR",{class:!0});var ne=y(g);for(let V=0;V<v.length;V+=1)v[V].l(ne);ne.forEach(p),se.forEach(p),M=A(B),i=k(B,"TBODY",{});var oe=y(i);for(let V=0;V<r.length;V+=1)r[V].l(oe);oe.forEach(p),B.forEach(p),F.forEach(p),_.forEach(p),this.h()},h(){D(e,"class","reset-button button svelte-12wvi4t"),D(t,"class","store-name svelte-12wvi4t"),D(d,"class","download-button button svelte-12wvi4t"),D(m,"class","download-button button svelte-12wvi4t"),D(g,"class","svelte-12wvi4t"),D(S,"class","review-table svelte-12wvi4t"),D(R,"class","review-table-box svelte-12wvi4t"),D(l,"class","review-box svelte-12wvi4t")},m(o,_){U(o,e,_),U(o,n,_),U(o,l,_),b(l,t),b(t,h),b(l,T),b(l,d),b(l,j),b(l,m),b(l,H),b(l,R),b(R,S),b(S,w),b(w,g);for(let c=0;c<v.length;c+=1)v[c]&&v[c].m(g,null);b(S,M),b(S,i);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(i,null);I||(E=[$(e,"click",a[14]),$(d,"click",a[15]),$(m,"click",a[16])],I=!0)},p(o,_){if(_&8&&f!==(f=o[3].Name+"")&&z(h,f),_&64){L=q(Object.keys(o[6][0]));let c;for(c=0;c<L.length;c+=1){const F=ce(o,L,c);v[c]?v[c].p(F,_):(v[c]=ie(F),v[c].c(),v[c].m(g,null))}for(;c<v.length;c+=1)v[c].d(1);v.length=L.length}if(_&64){G=q(o[6]);let c;for(c=0;c<G.length;c+=1){const F=re(o,G,c);r[c]?r[c].p(F,_):(r[c]=he(F),r[c].c(),r[c].m(i,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=G.length}},i:te,o:te,d(o){o&&(p(e),p(n),p(l)),le(v,o),le(r,o),I=!1,De(E)}}}function Be(a){let e,s,n,l,t;function f(u){a[11](u)}function h(u){a[12](u)}function T(u){a[13](u)}let d={handleSearch:a[8],handleGetReview:a[9],storeData:a[5]};return a[4]!==void 0&&(d.pagesToFetch=a[4]),a[2]!==void 0&&(d.searchInputStr=a[2]),a[3]!==void 0&&(d.selectedStore=a[3]),e=new je({props:d}),X.push(()=>Z(e,"pagesToFetch",f)),X.push(()=>Z(e,"searchInputStr",h)),X.push(()=>Z(e,"selectedStore",T)),{c(){ve(e.$$.fragment)},l(u){de(e.$$.fragment,u)},m(u,j){_e(e,u,j),t=!0},p(u,j){const m={};j&32&&(m.storeData=u[5]),!s&&j&16&&(s=!0,m.pagesToFetch=u[4],x(()=>s=!1)),!n&&j&4&&(n=!0,m.searchInputStr=u[2],x(()=>n=!1)),!l&&j&8&&(l=!0,m.selectedStore=u[3],x(()=>l=!1)),e.$set(m)},i(u){t||(Q(e.$$.fragment,u),t=!0)},o(u){P(e.$$.fragment,u),t=!1},d(u){fe(e,u)}}}function Oe(a){let e,s;return e=new Ee({}),{c(){ve(e.$$.fragment)},l(n){de(e.$$.fragment,n)},m(n,l){_e(e,n,l),s=!0},p:te,i(n){s||(Q(e.$$.fragment,n),s=!0)},o(n){P(e.$$.fragment,n),s=!1},d(n){fe(e,n)}}}function ie(a){let e,s=a[23]+"",n;return{c(){e=C("th"),n=K(s),this.h()},l(l){e=k(l,"TH",{class:!0});var t=y(e);n=J(t,s),t.forEach(p),this.h()},h(){D(e,"class","svelte-12wvi4t")},m(l,t){U(l,e,t),b(e,n)},p(l,t){t&64&&s!==(s=l[23]+"")&&z(n,s)},d(l){l&&p(e)}}}function ue(a){let e,s=a[20]+"",n;return{c(){e=C("td"),n=K(s),this.h()},l(l){e=k(l,"TD",{class:!0});var t=y(e);n=J(t,s),t.forEach(p),this.h()},h(){D(e,"class","svelte-12wvi4t")},m(l,t){U(l,e,t),b(e,n)},p(l,t){t&64&&s!==(s=l[20]+"")&&z(n,s)},d(l){l&&p(e)}}}function he(a){let e,s,n=q(Object.values(a[17])),l=[];for(let t=0;t<n.length;t+=1)l[t]=ue(ae(a,n,t));return{c(){e=C("tr");for(let t=0;t<l.length;t+=1)l[t].c();s=N(),this.h()},l(t){e=k(t,"TR",{class:!0});var f=y(e);for(let h=0;h<l.length;h+=1)l[h].l(f);s=A(f),f.forEach(p),this.h()},h(){D(e,"class","svelte-12wvi4t")},m(t,f){U(t,e,f);for(let h=0;h<l.length;h+=1)l[h]&&l[h].m(e,null);b(e,s)},p(t,f){if(f&64){n=q(Object.values(t[17]));let h;for(h=0;h<n.length;h+=1){const T=ae(t,n,h);l[h]?l[h].p(T,f):(l[h]=ue(T),l[h].c(),l[h].m(e,s))}for(;h<l.length;h+=1)l[h].d(1);l.length=n.length}},d(t){t&&p(e),le(l,t)}}}function Ie(a){let e,s,n,l,t,f,h,T,d,u,j,m,O,H,R,S,w,g,M,i,I="2025 - 榛果繽紛樂",E;ee.title=e=a[0]+" - 榛果繽紛樂";const L=[Oe,Be,ye],v=[];function G(r,o){return o&64&&(S=null),r[7]?0:(S==null&&(S=Object.keys(r[6]).length==0),S?1:2)}return w=G(a,-1),g=v[w]=L[w](a),{c(){s=N(),n=C("div"),l=N(),t=C("div"),f=C("img"),T=N(),d=C("div"),u=C("h1"),j=K(a[0]),m=N(),O=C("h2"),H=K(a[1]),R=N(),g.c(),M=N(),i=C("footer"),i.textContent=I,this.h()},l(r){ke("svelte-wrcujp",ee.head).forEach(p),s=A(r),n=k(r,"DIV",{id:!0,style:!0}),y(n).forEach(p),l=A(r),t=k(r,"DIV",{class:!0});var _=y(t);f=k(_,"IMG",{src:!0,alt:!0,style:!0}),T=A(_),d=k(_,"DIV",{class:!0});var c=y(d);u=k(c,"H1",{class:!0});var F=y(u);j=J(F,a[0]),F.forEach(p),m=A(c),O=k(c,"H2",{class:!0});var B=y(O);H=J(B,a[1]),B.forEach(p),c.forEach(p),R=A(_),g.l(_),_.forEach(p),M=A(r),i=k(r,"FOOTER",{class:!0,"data-svelte-h":!0}),Y(i)!=="svelte-livmhd"&&(i.textContent=I),this.h()},h(){D(n,"id","navbar-placeholder"),W(n,"height","50px"),we(f.src,h="https://src.hazelnut-paradise.com/GooMapReviewSnatcher.png")||D(f,"src",h),D(f,"alt","GooMapReviewSnatcher"),W(f,"width","100%"),W(f,"max-width","150px"),D(u,"class","title svelte-12wvi4t"),D(O,"class","subtitle svelte-12wvi4t"),D(d,"class","title-box svelte-12wvi4t"),D(t,"class","container svelte-12wvi4t"),D(i,"class","svelte-12wvi4t")},m(r,o){U(r,s,o),U(r,n,o),U(r,l,o),U(r,t,o),b(t,f),b(t,T),b(t,d),b(d,u),b(u,j),b(d,m),b(d,O),b(O,H),b(t,R),v[w].m(t,null),U(r,M,o),U(r,i,o),E=!0},p(r,[o]){(!E||o&1)&&e!==(e=r[0]+" - 榛果繽紛樂")&&(ee.title=e),(!E||o&1)&&z(j,r[0]),(!E||o&2)&&z(H,r[1]);let _=w;w=G(r,o),w===_?v[w].p(r,o):(Te(),P(v[_],1,1,()=>{v[_]=null}),me(),g=v[w],g?g.p(r,o):(g=v[w]=L[w](r),g.c()),Q(g,1),g.m(t,null))},i(r){E||(Q(g),E=!0)},o(r){P(g),E=!1},d(r){r&&(p(s),p(n),p(l),p(t),p(M),p(i)),v[w].d()}}}const Fe="/api/search",Re="/api/reviews";function Ue(a,e,s){let{title:n}=e,{subtitle:l}=e,t="",f="",h=1,T=[],d=[],u=!1;const j=async()=>{if(s(7,u=!0),console.log(t),t===""){alert("請輸入搜尋關鍵字"),s(7,u=!1);return}try{const i=await fetch(Fe+`?storeName=${t}`);if(!i.ok){console.error("Error:",i.statusText),alert("無法取得搜尋結果");return}s(5,T=await i.json()),console.log(T)}catch(i){console.error(i),alert("無法取得搜尋結果")}finally{s(7,u=!1)}},m=async()=>{if(s(7,u=!0),console.log(f),f===""){alert("請選擇店家"),s(7,u=!1);return}try{const i=await fetch(Re+`?storeID=${f.ID}&pages=${h}`);if(!i.ok){console.error("Error:",i.statusText),alert("無法取得評論");return}s(6,d=await i.json()),console.log(d)}catch(i){console.error(i),alert("無法取得評論")}finally{s(7,u=!1)}},O=i=>{const I=document.createElement("a");let E="";switch(i){case"csv":const L=new Uint8Array([239,187,191]),v=Object.keys(d[0]).join(","),G=d.map(F=>Object.values(F).map(B=>typeof B=="string"&&(B.includes(",")||B.includes(`
`)||B.includes('"'))?`"${B.replace(/"/g,'""')}"`:B).join(",")),r=v+`
`+G.join(`
`),o=new Blob([L,r],{type:"text/csv;charset=utf-8"});E=window.URL.createObjectURL(o),I.href=E,I.download=`${f.Name}.csv`,I.click();break;case"json":const _=JSON.stringify(d,null,2),c=new Blob([_],{type:"application/json;charset=utf-8"});E=window.URL.createObjectURL(c),I.href=E,I.download=`${f.Name}.json`,I.click();break}window.URL.revokeObjectURL(E)};Ce(async()=>{getNavbar()});function H(i){h=i,s(4,h)}function R(i){t=i,s(2,t)}function S(i){f=i,s(3,f)}const w=()=>{s(2,t=""),s(5,T=[]),s(6,d=[])},g=()=>O("csv"),M=()=>O("json");return a.$$set=i=>{"title"in i&&s(0,n=i.title),"subtitle"in i&&s(1,l=i.subtitle)},[n,l,t,f,h,T,d,u,j,m,O,H,R,S,w,g,M]}class He extends pe{constructor(e){super(),be(this,e,Ue,Ie,ge,{title:0,subtitle:1})}}export{He as default};
